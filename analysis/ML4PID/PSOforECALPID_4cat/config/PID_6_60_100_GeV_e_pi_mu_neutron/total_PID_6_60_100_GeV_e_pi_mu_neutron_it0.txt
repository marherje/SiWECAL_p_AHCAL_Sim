##Parameters for the Particle Swarm Optimization

##RunOn = EKPSL5 | EKPSL5 | NAFSL5 | NAFSL6 | IFIC | DESY
RunOn=IFIC

## Swarm Parameters
##change to 40-50 
NParticles=40 
##change to 25-30
NIterations=20 
wIneratia=0.729
wMemory=1.49445
wSwarm=1.49445

##FOM = Weighted_1_AUC | Weighted_AUC | ROCIntegral | Separation | rejB_vs_effS_0.1 | rejB_vs_effS_0.3 |rejB_vs_effS_0.5 | Chi2_B_muSB
FOM=Weighted_1_AUC
ADThreshold=0.20
KSThreshold=0.10
FindBestvariables=0 
MaxVariablesInCombination=100
##only add variable if new FOM > ImprovementThreshold*FOM
ImprovementThreshold=1.005

## Set FindBestVariables=0 to not iterate over additional variables
## repeat each training additional times with different random seeds for test/training splitting (0==no repetition)
## only reasonable if SplitSeed=0 is in the PreparationString a few lines down
## and if UseEvenOddSplitting=0
## FOM and KS will be taken as the worst of all trainings
#Change to 2 or 3 later
RepeatTrainingNTimes=1 
## draw random starting variables, 0== use predermined starting variables
DrawNRandomAsStartingVars=0
##NOTYET SaveTrainingsToTrees=False

##TMVA Options
FactoryString=!V:!Silent:Color:!DrawProgressBar:Transformations=I;D;P;G,D:AnalysisType=multiclass
PreparationString=SplitMode=Random:NormMode=NumEvents:!V
##if you want to limit the number of events do it eiter PreparationString or here
##nTrain_Signal=
##nTrain_Background=
##nTest_Signal=
##nTest_Background=
##Weight expression, might need to be declared in WeightVariables furhter down
## probably same syntax as in TTree::Draw 
BWeightExpression=Weight
CWeightExpression=Weight
OWeightExpression=Weight
NWeightExpression=Weight

##Method to train and test
##only tested with BDT so far
## you might want to think abount you handle NEGATIVE WEIGHTS
##Parameters in MethodParams will be overwritten if they span the search space
MethodType=TMVA::Types::kBDT
MethodParams=!H:!V:NTrees=100:BoostType=Grad:Shrinkage=0.01:UseBaggedBoost:GradBaggingFraction=0.3:nCuts=10:MaxDepth=2:NegWeightTreatment=IgnoreNegWeightsInTraining
##:NEventsMax=200


## search space
##coord=["Name",minValue,maxValue,maxVelocity,"int|float"]
##if min and max value are the same the value is not varied
coord=["NTrees",800,1200,50,"int"]
coord=["Shrinkage",0.001,0.05,0.005,"float"]
coord=["GradBaggingFraction",0.1,0.8,0.05,"float"]
coord=["nCuts",20,80,5,"int"]
coord=["MaxDepth",2,8,1,"int"]

##--------------------------------------------------
##Source Trees:
## if UseEvenOddSplitting=1, the input trees will be split in training/testsample with Variable "Evt_Odd" 
## maybe change the variable in PSO/PrepareTrees.C
## else TMVA will use built in splitting
UseEvenOddSplitting=0
## use selections without quotation marks. E.g.:
SelectionString=

SourceBFile=data/PID_6_60_100_GeV/resolution_e-_result_total.root
SourceBTree=ntp

SourceCFile=data/PID_6_60_100_GeV/resolution_pi-_result_total.root
SourceCTree=ntp

SourceOFile=data/PID_6_60_100_GeV/resolution_mu-_result_total.root
SourceOTree=ntp

SourceNFile=data/PID_6_60_100_GeV/resolution_neutron_result_total.root
SourceNTree=ntp

##------------------------------------------------
##Variables in Format ["NAME","TYPE","LENGTH","VarExpression"]
##IMPORTANT dont leave a blank line between the initial and the end variables line
##variables the optimization starts with
InitialVariables:
["ecal_weighte","F","","ecal_weighte"]
["ecal_radius90_layer_1","F","","ecal_radius90_layer_1"]
["ecal_radius90_layer_5","F","","ecal_radius90_layer_5"]
["ecal_radius90_layer_10","F","","ecal_radius90_layer_10"]
["ecal_radius90_layer_14","F","","ecal_radius90_layer_14"]
["ecal_sume_layer_1","F","","ecal_sume_layer_1"]
["ecal_sume_layer_5","F","","ecal_sume_layer_5"]
["ecal_sume_layer_10","F","","ecal_sume_layer_10"]
["ecal_sume_layer_14","F","","ecal_sume_layer_14"]
["ecal_shower_sume_max_layer","F","","ecal_shower_sume_max_layer"]
["ecal_shower_sume_start_10_layer","F","","ecal_shower_sume_start_10_layer"]
["ecal_shower_sume_end_10_layer","F","","ecal_shower_sume_end_10_layer"]
["hcal_weighte","F","","hcal_weighte"]
["hcal_radius90_layer_1","F","","hcal_radius90_layer_1"]
["hcal_radius90_layer_5","F","","hcal_radius90_layer_5"]
["hcal_radius90_layer_10","F","","hcal_radius90_layer_10"]
["hcal_radius90_layer_14","F","","hcal_radius90_layer_14"]
["hcal_sume_layer_1","F","","hcal_sume_layer_1"]
["hcal_sume_layer_5","F","","hcal_sume_layer_5"]
["hcal_sume_layer_10","F","","hcal_sume_layer_10"]
["hcal_sume_layer_14","F","","hcal_sume_layer_14"]
["hcal_shower_sume_max_layer","F","","hcal_shower_sume_max_layer"]
["weighte_ratio","F","","weighte_ratio"]
["total_bar_z","F","","total_bar_z"]
["total_mol","F","","total_mol"]
["total_MIP_Likeness","F","","total_MIP_Likeness"]	
["nhit_ratio","F","","nhit_ratio"]
["total_hits_max_distance","F","","total_hits_max_distance"]
["total_nhit","F","","total_nhit"]
["ecal_MIP_Likeness","F","","ecal_MIP_Likeness"]
["hcal_MIP_Likeness","F","","hcal_MIP_Likeness"]
["sume_ratio","F","","sume_ratio"]
["weighte_ratio","F","","weighte_ratio"]
["ecal_hits_max_distance","F","","ecal_hits_max_distance"]
["hcal_hits_max_distance","F","","hcal_hits_max_distance"]
EndVariables

##---------------------------------------------------
## variables the swarm can try
AdditionalVariables:
EndVariables

##---------------------------------------------------
## variables used for reweighting and stuff
WeightVariables:
["Weight","F","","Weight"]
EndVariables
##---------------------------------------------------

